<h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Overview">Overview</h2>
    <p>
      When using a Stripe account with your Brightcove Beacon app, you can add custom metadata to Stripe subscriptions/ purchases. Then, you can use the Stripe API to search for that specific metadata associated with subscription events.
    </p>
    <p>This topic will show you how to do the following:</p>
    <ul>
      <li>Add custom metadata to Stripe subscriptions/ purchases</li>
      <li>Use the Stripe API to search for that specific metadata in any subscription/purchase to return a list</li>
    </ul>
  </section>

  <section class="bcls-section">
    <h2 id="Prerequisites">Prerequisites</h2>
    <p>
     To use the Stripe API as shown in this topic, you will need the following:
    </p>
    <ul>
      <li><a href="https://dashboard.stripe.com/register">Stripe account</a></li>
      <li><a href="https://www.postman.com/downloads/">Postman</a> or another API platform
        <p>You can use the API platform of your choice to interact with the Stripe API, but for these examples, we will use Postman.</p>
      </li>
    </ul>
  </section>

  <section class="bcls-section">
    <h2 id="Adding_custom_metadata">Adding custom metadata</h2>
    <p>You can add a set of custom key-value pairs associated with a Stripe subscription. To add metadata, you can use the Stripe API or the Stripe dashboard as follows:</p>
    <ol class="bcls-tasklist">
      <li>Log into your Stripe account.</li>
      <li>In the left navigation, select <strong>Subscriptions</strong>.</li>
      <li>
        <p>In the <strong>Metadata</strong> section, add your desired data.</p>
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/s-monetization-img/managing-stripe-metadata/set-metadata.png" alt="set stripe metadata" />
        </figure>
      </li> 
      <li>For details about adding metadata, see Stripe's <a href="https://stripe.com/docs/api/subscriptions/create#create_subscription-metadata">Create subscription metadata</a> reference.</li> 
    </ol>
  </section>

  <section class="bcls-section">
    <h2 id="Understanding_the_Stripe_API">Understanding the Stripe API</h2>
    <h3 id="Base_URL">Base URL</h3>
    
    <p>The base URL for the Stripe API is:</p>
    
    <pre><code class="language-http" translate="No">https://api.stripe.com</code></pre>

    <h3 id="Authentication">Authentication</h3>
    
    <p>Requests are authenticated with your API key in the <code translate="No">Authorization </code> header:</p>
    
    <pre><code class="language-json" translate="No">Authorization: Bearer {api_key}</code></pre>

    <h3 id="API_collection">API collection</h3>
    
    <p>The Stripe API Collection is hosted within <a href="https://www.postman.com/stripedev/workspace/stripe-developers/overview">Stripe's Postman public workspace</a>. This allows you to fork from the public workspace into yours.</p>
    <p>If you don't want to fork the collection from the public workspace, you can import it from the <a href="https://github.com/stripe/stripe-postman">stripe-postman</a> GitHub repository.</p>
    
  </section>

  <section class="bcls-section">
    <h2 id="Creating Postman environment">Creating Postman environment</h2>
    <p>You can use the API platform of your choice to interact with the Stripe API, but for these examples, we will use Postman.</p>
    
    <ol class="bcls-tasklist-restart">
      <li>Login or create an account with <a href="https://www.postman.com/">Postman</a>.</li>
      <li>Either fork the environment template within the <a href="https://www.postman.com/stripedev/workspace/stripe-developers/overview">Postman Stripe public workspace</a>, or create a new envionment within Postman. We'll create a new environment.</li>
      <li>
        <p>In your workspace, click <strong>New</strong>.</p>
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/s-monetization-img/managing-stripe-metadata/new-environment.png" alt="create new" />
        </figure>
      </li>
      <li>
        <p>In the dialog, select <strong>Environment</strong>.</p>
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/s-monetization-img/managing-stripe-metadata/new-environment-2.png" alt="select environment" />
        </figure>
      </li>
      <li>
        <p>Add your secret key as an environment variable and click <strong>Save</strong>.</p>
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/s-monetization-img/managing-stripe-metadata/create-key-variable.png" alt="create secret key variable" />
        </figure>
      </li>
      <li>Click <img class="ui-image" width="16px" src="/assets/images/s-monetization-img/managing-stripe-metadata/add-tab-icon.png" alt="Add tab icon"> to open a new tab.</li>
      <li>
        <p>In the request dialog, do the following:</p>
        <ul>
          <li>Select <strong>Authorization</strong></li>
          <li>For <strong>Type</strong>, select <strong>Bearer Token</strong></li>
          <li>For Token, enter <code translate="No">{% raw %}{{secret_key}}{% endraw %}</code></li>
        </ul>
        <p>If your environment is set up correctly, you should see your secret key value when you mouse over the <code translate="No">secret_key</code> variable.</p>
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/s-monetization-img/managing-stripe-metadata/mouse-over-key.png" alt="mouse over key variable" />
        </figure>
      </li>
      <li>Click <strong>Save</strong>.</li>
      <li>In the dialog, do the following:
        <ul>
          <li>Add a <strong>Request name</strong></li>
          <li>Choose or create a new collection</li>
          <li>Click <strong>Save</strong></li>
        </ul>
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/s-monetization-img/managing-stripe-metadata/save-request.png" alt="save request" />
        </figure>
      </li>
    </ol>
  </section>

  <section class="bcls-section">
    <h2 id="Searching_subscriptions_with_metadata">Searching subscriptions with metadata</h2>
    <p>In a previous steip, we added custom metadata (<code translate="No">Samsung:yes</code>) to one of our subscription packages. Now, we will use the Stripe API to search for subscriptions with that metadata.</p>
    
    <ol class="bcls-tasklist-restart">
      <li>Login or create an account with <a href="https://www.postman.com/">Postman</a>.</li>
      
    </ol>
  </section>
</article>